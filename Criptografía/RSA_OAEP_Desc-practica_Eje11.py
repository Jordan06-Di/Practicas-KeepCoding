from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
from Crypto.Hash import SHA256,SHA512
import os

my_path = os.path.abspath(os.getcwd())

fichero_fpriv = my_path + "/claveprivada-RSA_desc_oaep.pem"
fpriv=open(fichero_fpriv,'r')
keypr= RSA.import_key(fpriv.read())

#mensajeCifrado=bytes.fromhex("3489a5861a3bc929290087082aeb1e9446daa2fc20a9aa6af333354db7401787c0d47c8839a885feea92d3251e8a4f770c367d4b25d76051d19d624caa2e0e617327d61a83abad032851700cabfffcd486b5d08db11eeafcb6404619aefd82f6f504e7640d5568d325e0d887a395f238654f9d242629f0c450c13923d2a2dedff9e61c52db7d96471b5faf29ec541fb9acdd8eaf78b7af7e6845847bf26433bcb0c0a175ad933f7c96ac229996bb660727d20f417b11717cd0f87f09126fa99fe11719fecd5c863cd3cad37040c1ff6e52a3ca10f3078bdc2cf4819666304ba97e10b0fd03b0105a9175e2ded584de98d38a698b803e6d8ad8c3032418372249")
mensajeCifrado=bytes.fromhex("a4369c00aed32de131d88a145e060e56d2bb27b9a715ddabaf1b3e42601e7b18d2dea873aa0f433e230297d9b07f2a816d9e4e206a90b6c178e8f3ca2396757170360ec6eef7f8f9bce8e9ba5e376babd59c8716d197e73a7ba670ccff88b554e2348e042a4b1a78e798a031da6f56b3d14400405bd0f003dfa57f04de6c5f23de7c6a8a83334148396933fc8ecb14e0450d862407ebed6729217730be9e068f653155f609c46197ec7240ba253831537161eca9f913c4be76b218bd887cbf2e8177be5e5490bf30bd9a7627b07f630a8824900d644c537b4ed1cfefeb5985a7a7583cc5c3da130cdb0675776829970d0e54853d824af351f00c0fab97999297")
descifrador = PKCS1_OAEP.new(keypr, SHA256)
decrypted = descifrador.decrypt(mensajeCifrado)
print("Descifrado: ", decrypted.hex())






